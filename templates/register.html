<!DOCTYPE html>
<html>
<head>
    {% load static %}
    <meta charset="utf-8">
    <title>用户注册界面</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="{% static 'lib/layui-v2.6.3/css/layui.css' %}" media="all">
    <link rel="stylesheet" href="{% static 'css/public.css' %}" media="all">
    <link rel="stylesheet" href="{% static 'js/lay-module/step-lay/step.css' %}" media="all">

    <style>

        .logo-title {
            text-align: center;
            letter-spacing: 2px;
            padding: 14px 0;
        }

        .logo-title h1 {
            color: #009688;
            font-size: 30px;
            font-weight: bold;
        }


    </style>
    <script>


    </script>
</head>

<body>
<div class="layuimini-container">
    <div class="layuimini-main">


        <div class="layui-form-item logo-title">
            <legend><b><h1>现代服务业发展水平评估系统<br>用户注册界面</h1></b></legend>
        </div>


        <!--div class="layui-carousel" id="stepForm" lay-filter="stepForm" style="margin: 0 auto;">
            <div carousel-item-->
        <div>
            <form class="layui-form" id="register_form" style="margin: 0 auto;max-width: 460px;padding-top: 40px;" method="POST"  >
                <div class="layui-form-item">
                    <label class="layui-form-label">用户名:</label>
                    <div class="layui-input-block">
                        <input id="user_name" type="text" name="user_name" placeholder="请填写用户名"
                               class="layui-input" lay-verify="" required/>

                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">用户邮箱:</label>
                    <div class="layui-input-block">
                        <input id="user_email" type="text" name="user_email" placeholder="请填写用户邮箱"
                               class="layui-input" lay-verify="email" required/>
                        <button class="layui-btn" id="send_email" type="button">
                            &emsp;点击发送验证码&emsp;
                        </button>
                    </div>

                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">验证码:</label>
                    <div class="layui-input-block">
                        <input type="text" name="v_code" id="v_code" placeholder="请填写邮箱收到的验证码" value=""
                               class="layui-input" lay-verify="number" required>
                        <input type="hidden" name="h_code" id="h_code" value="">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">账号密码:</label>
                    <div class="layui-input-block">
                        <input type="password" id="user_pwd" name="user_pwd" lay-verify="required|pass"
                               placeholder="请输入密码" autocomplete="off" class="layui-input" value="">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">请重新输入密码:</label>
                    <div class="layui-input-block">
                        <input type="password" id="pwd_confirm" lay-verify="confirmPass" placeholder="请重新输入密码"
                               autocomplete="off" class="layui-input" value="" required>
                    </div>
                </div>
                <!--div class="layui-form-item">
                    <label class="layui-form-label">用户手机号:</label>
                    <div class="layui-input-block">
                        <input type="text" placeholder="请填写用户手机号" class="layui-input" lay-verify="phone" />

                    </div>
                </div-->
                <div class="layui-form-item">
                    <label class="layui-form-label">用户类型:</label>
                    <div class="layui-input-block">
                        <select lay-verify="required" id="user_type" name="user_type">
                            <option value="企业用户" selected>企业用户</option>
                            <option value="政府用户">政府用户</option>
                        </select>
                    </div>
                </div>
                <!--div class="layui-form-item">
                    <label class="layui-form-label">备注说明:</label>
                    <div class="layui-input-block">
                        <textarea placeholder="入款备注" value="" class="layui-textarea"></textarea>
                    </div>
                </-->
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button class="layui-btn layui-btn-fluid" lay-submit type="submit" lay-filter="register">
                            &emsp;确认注册&emsp;
                        </button>
                    </div>
                </div>
            </form>
        </div>
        <!--div>
            <form class="layui-form" style="margin: 0 auto;max-width: 460px;padding-top: 40px;">
                <div class="layui-form-item">
                    <label class="layui-form-label">用户名:</label>
                    <div class="layui-input-block">
                       <input id="name_show" type="text" readonly="readonly" value="" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">用户邮箱:</label>
                    <div class="layui-input-block">
                        <input id="email_show" type="text" readonly="readonly" value="" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">用户类型:</label>
                    <div class="layui-input-block">
                         <input id="type_show" type="text" readonly="readonly" value="" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-input-block">
                        <button type="button" class="layui-btn layui-btn-primary pre">上一步</button>
                        <button class="layui-btn" lay-submit lay-filter="formStep2" id="submit_bt" >
                            &emsp;确认注册&emsp;
                        </button>
                    </div>
                </div>
            </form>
        </div>
        <div>
            <div style="text-align: center;margin-top: 90px;" >
                <div id="text_show"  style="text-align: center;margin-top: 90px;"> </div>
                <div style="font-size: 24px;color: #333;font-weight: 500;margin-top: 30px;">
                    <div class="layui-input-block">
                     <input id="result_show" type="text" readonly="readonly" value="" class="layui-input" style="border-style:none;width:40%">
                    </div>
                </div>
                <div style="font-size: 14px;color: #666;margin-top: 20px;">预计两小时到账</div>
            </div>
            <div style="text-align: center;margin-top: 50px;">
                <button class="layui-btn next">再入一笔</button>
                <button class="layui-btn layui-btn-primary">查看账单</button>
            </div>
        </div>
    </div>
</div-->
        <hr>
        <div style="color: #666;margin-top: 30px;margin-bottom: 40px;padding-left: 30px;">
            <h3>说明</h3><br>
            <h4>这是只实现了功能的注册界面</h4>
            <p>如果需要，这里的布局可以随时改动</p>

            <h4>例如添加手机号等模块</h4>
            <p>都可以改都可以改都可以改都可以改</p>
        </div>
    </div>


</div>
<script src="{% static 'lib/layui-v2.6.3/layui.js' %}" charset="utf-8"></script>
<script src="{% static 'js/lay-config.js' %}" charset="utf-8"></script>
<script>

     layui.use([ 'form', 'step'], function () {
         var $ = layui.$,
             form = layui.form,
             step = layui.step;
         //发送验证码模块js代码
         var but = document.getElementById("send_email")
         var time = 60; //定义剩下的秒数
         but.addEventListener('click', function () {
             but.disabled = true;
             var email = document.getElementById("user_email").value;
             var hcode = document.getElementById("h_code")
             $.ajax({
                 url: '/sendVcode',
                 method: 'get',
                 data: {'user_email': email},

                 success: function (msg) {
                     var xml = msg

                     var json = JSON.parse(xml)
                     console.log(json)
                     var status = json.status
                     var code = json['code']
                     if (status == "1"){
                         hcode.value = code
                     }
                     else{
                         alert(code)
                     }

                 },
                 error: function (msg) {
                     alert(msg)
                 }
             })
             var timer = setInterval(function () {
                 if (time == 0) {
                     //清除定时器和复原按钮
                     clearInterval(timer);
                     but.disabled = false;
                     but.innerHTML = '重新发送验证码';
                     time = 60; //这个10是重新开始
                 } else {
                     but.innerHTML = '请在' + time + '秒后重试';
                     time--;
                 }
             }, 1000);
         })
         form.verify(
             {
                 confirmPass: function (value) {
                     if ($('input[name=user_pwd]').val() !== value)
                         return '提示：两次输入密码不一致！';

                 }
             }
         )




     })


</script>
</body>
</html>